
<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="manifest" href="/manifest.json">
<script>
if ('serviceWorker' in navigator) { navigator.serviceWorker.register('/service-worker.js'); }
</script>
<style>
  body { font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', sans-serif;
         margin:0; background:#fff; text-align:center; color:#222; transition: opacity 1s ease-in-out; }
  .splash, .dealer-name-prompt { position:fixed; top:0; left:0; right:0; bottom:0; background:#fff;
            display:flex; flex-direction:column; align-items:center; justify-content:center; z-index:9999; }
  .hidden { display:none; }
  h1 { font-size:28px; font-weight:600; margin-bottom:10px; }
  input, textarea { width:90%; padding:14px; margin:8px 0;
                    border-radius:12px; border:1px solid #ddd; font-size:16px; }
  button { background:#333; color:white; padding:14px;
           border:none; border-radius:12px; font-weight:600; margin-top:12px;
           width:94%; font-size:18px; }
  #vin-preview { font-size:14px; color:#777; }
</style>
</head>
<body>

<!-- Splash Screen -->
<div class="splash" id="splash">
  <h1 id="greeting">Good Morning</h1>
</div>

<!-- Dealer Name Prompt -->
<div class="dealer-name-prompt hidden" id="dealerNamePrompt">
  <h1>ðŸ‘‹ What's your dealer name?</h1>
  <input type="text" id="dealerNameInput" placeholder="Enter dealer name">
  <button onclick="saveDealerName()">Continue</button>
</div>

<header style="display:flex; justify-content:space-between; padding:12px 20px; font-weight:700;">
  <div onclick="window.location='/submissions'" style="cursor:pointer;">ðŸ“„ My Submissions</div>
  <div onclick="promptAdmin()" style="cursor:pointer;">Gateway Leasing</div>
</header>

<h2>Vehicle Appraisal</h2>

<form method="POST" enctype="multipart/form-data">
  <input type="text" name="vin" id="vin" placeholder="Enter VIN or Scan" required><br>
  <div id="vin-preview"></div>

  <input type="text" name="distance" placeholder="Kilometres" required><br>

  <label>Upload Photos (up to 12)</label>
  <input type="file" name="photos" multiple accept="image/*" capture="environment"><br>

  <textarea name="notes" placeholder="Additional Notes"></textarea><br>

  <input type="email" name="user_email" id="user_email" placeholder="Email Address"><br>
  <input type="tel" name="user_phone" id="user_phone" placeholder="Phone Number"><br>

  <button type="submit">Submit</button>
</form>

<script>
function setGreeting(){
  let h = new Date().getHours();
  let greeting = h < 12 ? "Good Morning" : (h < 17 ? "Good Afternoon" : "Good Evening");
  document.getElementById('greeting').innerText = greeting;
}
setGreeting();

// Splash -> Dealer Name prompt logic
setTimeout(()=>{ 
  document.getElementById('splash').classList.add('hidden');
  if(!localStorage.getItem('dealer_name')){
    document.getElementById('dealerNamePrompt').classList.remove('hidden');
  }
},2000);

function saveDealerName(){
  const name = document.getElementById('dealerNameInput').value;
  if(name.trim()){
    localStorage.setItem('dealer_name', name);
    document.getElementById('dealerNamePrompt').classList.add('hidden');
  }
}

// Autofill email if saved
document.addEventListener('DOMContentLoaded', ()=>{
  if(localStorage.getItem('user_email')) document.getElementById('user_email').value = localStorage.getItem('user_email');
});
document.querySelector('form').addEventListener('submit', ()=>{
  localStorage.setItem('user_email', document.getElementById('user_email').value);
});

function promptAdmin(){
  let pw = prompt("Enter admin password");
  if(pw && pw.toLowerCase() === '0000'){
    window.location='/admin';
  }
}
</script>
</body>
</html>
